pico-8 cartridge // http://www.pico-8.com
version 35
__lua__
-- "a pretty flower"
-- by john doty

-- based on what i saw in
-- https://youtu.be/s6kxh_zyiqs
-- https://pyrofoux.itch.io/tea-garden

local flower_scale=2
local flower_size=6
local actual_scale=0

function _init()
end

function _update()
 if btnp(‚¨ÜÔ∏è) and flower_size<64 then
  flower_size+=2
  the_flower=nil
  actual_scale=0
 end
 if btnp(‚¨áÔ∏è) and flower_size>2 then
  flower_size-=2
  the_flower=nil
  actual_scale=0
 end
 if btnp(‚¨ÖÔ∏è) and flower_scale>1 then
  flower_scale-=1
 end
 if btnp(‚û°Ô∏è) and flower_scale<10 then
  flower_scale+=1
 end

 if btnp(‚ùé) or btnp(üÖæÔ∏è) or the_flower==nil then
  the_flower=flower:new(flower_size)
  actual_scale=0
 end

 actual_scale=mid(0,actual_scale+0.1,flower_scale)
end

function princ(txt,y,col)
 local x=64-flr((4*#txt-1)/2)
 print(txt,x,y,col)
end

function _draw()
 cls()
 princ("a pretty flower", 16, 7)
 princ("of "..tostr(flower_size).." pixels", 22, 7)
 the_flower:draw(64,72,actual_scale)
 princ("seed: "..sub(tostr(the_flower.seed,0x3),7), 88, 7)
 princ("press üÖæÔ∏è or ‚ùé for another", 96, 7)
 princ("‚¨ÜÔ∏è and ‚¨áÔ∏è to grow and shrink", 102, 7)
 princ("‚¨ÖÔ∏è and ‚û°Ô∏è to zoom", 108, 7)
end
-->8
-- actual flower stuff.
flower={}
function flower:new(size,seed,stem)
 if seed==nil then seed=rnd() end
 if stem==nil then stem=true end
 srand(seed)

 local flx=false
 if flr(rnd(2))==0 then
  flx=true
 end

 local f={
   size=size,
   seed=seed,
   stem=stem,
   symm=flr(rnd(2)),
   flx=flx
 }

 local colors={}
 while colors[4]==colors[5] do
  colors={
   0,0,0,
   flr(rnd(8)+8),
   flr(rnd(8)+8)
  }
 end

 local symm=f.symm
 for y=0,size-1 do
  for x=0,size-1 do
   local c=rnd(colors)
   sset(x,y+64,c)
   if symm==0 then
    sset(y,x+64,c)
   else
    sset(size-1-x,y+64,c)
   end
  end
 end

 return setmetatable(f,{__index=self})
end

function flower:draw(x,y,scale)
 local sz=self.size
 local flx=self.flx

 if self.stem then
  local sx=flr(x-16*scale/2)
  local sy=flr(y-16*scale)

  sspr(
   16*self.symm,8,16,16,
   sx,sy,16*scale,16*scale,
   flx)
 end

 local fx=flr(x-sz*scale/2)
 local fy=flr(y-(16+sz)*scale/2)

 sspr(
  0,64,sz,sz,
  fx,fy,sz*scale,sz*scale,
  flx)
end

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000bb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000bbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00bb00bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
003b000b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0003b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0bb0bb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3bbbbb00000000000000bb03b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03330b0000000000000033bbb00bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000003b0000000000000003bb0b33000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000003b0000000000000003bb300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000003b000000000000003b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000003b000000000000003b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
